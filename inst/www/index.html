<!DOCTYPE html>


<html>

<head>
  <meta charset="utf-8">
  <title></title>
  
  <!-- opencpu for R interaction -->
  <script src="opencpu/jquery-1.10.2.min.js"></script>
  <script src="opencpu/opencpu-0.4.js"></script>
  
     <!-- <script type="text/javascript" src="js/jquery-2.2.0.min.js"></script> -->
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <!-- <script type="text/javascript" src="js/d3.js"></script> -->
  <script src="https://d3js.org/d3.v4.js"></script>
    <script type="text/javascript" src="js/d3_functions/multiplot_utilities.js"></script>
  
  <link rel="stylesheet" type="text/css" href="css/bootstrap.css">
  <link rel="stylesheet" type="text/css" href="css/main.css">
</head>

  <body>
    
  <div class="row" style="padding:15px">
    <div class="col-md-3">
      <div class="tabbable">
        <ul id="tabs" class="nav nav-tabs">
          <li class="active mtab"><a href='#setup' data-toggle="tab">Setup</a></li>
          <li class="mtab"><a href='#simulate' data-toggle="tab">Simulate patient</a></li>
        </ul>
        <div id="tside" class="tab-content">
          <div id="setup" class='tab-pane active'>
            <div class="row center">
                <div class="col-xs-6 frm">
                  <h5>Target toxicity level</h5>
                </div>
                <div class="col-xs-6 frm">
                  <input id='target' class="vcenter" type="number" min='0' max='1' step='0.01' value='0.4'>
                </div>
                <div class="col-xs-6 frm">
                  <h5>Choose model</h5>
                </div>
                <div class="col-xs-6 frm">
                  <select id='smodel' style='max-width: 200px;' class="vcenter">
                  </select>
                </div>
                <div class="col-xs-6 frm">
                  <h5>Dose selection criteria</h5>
                </div>
                <div class="col-xs-6 frm">
                  <h5>Closest to target toxicity level without dose skipping</h5>
                </div>
                <div class="col-xs-6 frm">
                  <h5>Cohort Size</h5>
                </div>
                <div class="col-xs-6 frm">
                  <input id='cohortSize' class="vcenter" type="number" min='0' max='5' step='1' value='2'>
              </div>
            </div>
          </div>
          <div id="simulate" class='tab-pane'>
            <div class="row center">
              <div class="col-xs-6 frm">
              <button id="submitbutton" type="button" class="btn btn-primary">Simulate One patient</button>
              </div>
              <div class="col-xs-6 frm">
              </div>
              <div class="col-xs-6 frm">
              <h5>Simulate trial with patients:</h5>
              </div>
              <div class="col-xs-6 frm">
              <input id='sPatients' class="vcenter" type="number" min='0' step='1' value='10'>
              </div>
              <div class="col-xs-6 frm">
              <button id="submitMany" type="button" class="btn btn-primary">Simulate <span id="manyPatients">10</span> patient Trial</button>
              </div>
              <div class="col-xs-6 frm">
              <button id="resetButton" type="button" class="btn btn-primary">Reset Data</button>
              </div>
          </div>
        </div>
      </div>
    </div>
  </div>
      
      
      
    <div class="col-md-9">
      <div class="tabbable">
        <ul id="tabs" class="nav nav-tabs">
          <li class="mtab"><a href='#prior' data-toggle="tab">Prior</a></li>
          <li class="active mtab"><a href='#graph' data-toggle="tab">Fitted Model</a></li>
          <li class="mtab"><a href='#posterior' data-toggle="tab">Posterior</a></li>
          <li class="mtab"><a href='#dose' data-toggle="tab">Dose</a></li>
        </ul>
        <div id="tcontent" class="tab-content">
          <div id="prior" class='tab-pane'>
            <div class="row">
              <div id="priorHist0" class="col-md-6">
              </div>
              <div id="priorHist1" class="col-md-6">
              </div>
              <div  id="priorModel" class="col-md-12">
              </div>
            </div>
          </div>
          <div id="graph" class='tab-pane active'>
          </div>
          <div id="posterior" class='tab-pane'>
            <div class="row">
              <div id="postHist0" class="col-md-6">
              </div>
              <div id="postHist1" class="col-md-6">
              </div>
              <div  id="postModel" class="col-md-12">
              </div>
            </div>
          </div>
          <div id="dose" class='tab-pane'>
            <div id="doseGraph">
            </div>
          </div>
      </div>
      </div>
    </div>

    <script type="text/javascript" src="js/random.js"></script>
    <script type="text/javascript" src="js/model.js"></script>
    <script type="text/javascript" src="js/modelR.js"></script>
    <script type="text/javascript" src="js/graphs.js"></script>
    <script type="text/javascript" src="js/main.js"></script>
    <script>
        d3.select('#target')
        .on('input', function(){
        setup.target = this.value;
        d3.select('#targetLine')
          .transition()
          .duration(param.speed)
            .attr("y1", y(setup.target))
            .attr("y2", y(setup.target))
        
      });
      
      d3.select("#smodel")
        .on('change', function(){
          model = models[d3.select('#smodel').property('selectedIndex')];
          console.log(model.name);
          rerunModel();
        });
      
      d3.select('#submitbutton')
        .on('click', function() {
        
          addPatient(modelGraph);
          
        });
      
      d3.select('#sPatients')
        .on('input', function(){
          sPatients = this.value
          d3.select('#manyPatients').text(sPatients)
        })
      
      d3.select('#cohortSize')
        .on('input', function(){
          cohortSize = this.value;
        })
      
      d3.select('#submitMany')
        .on('click', function() {
        
          //resetTrialData();
          //resetGraph();
          addPatients(sPatients);
          
        });
      

      
      d3.select('#resetButton')
        .on('click', function(){
          resetTrialData();
          resetGraph();
        })
    </script>
</body>


</html>
